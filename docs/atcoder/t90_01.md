# 001 - Yokan Party（★4）
2025-10-13

[問題](https://atcoder.jp/contests/typical90/tasks/typical90_a)

## 解答
[提出 #70120367](https://atcoder.jp/contests/typical90/submissions/70120367)

```haskell
type I = [[Int]]
type O = Int

solve :: I -> O
solve [[n,l],[k],as] = ans
    where
        ans = binSearch (f ds k) 0 l
        ds = zipWith (-) (as ++ [l]) (0:as)

f :: [Int] -> Int -> Int -> Bool
f ds k x = f' ds (k+1) 0
    where
        f' as 0 acc = True
        f' [] k' acc = False
        f' (a:as) k' acc
            | acc + a >= x = f' as (k'-1) 0
            | otherwise = f' as k' (acc + a)

```
答えを二分探索でみつける。`f`は、ようかんを長さ`x`以上の`k+1`個のピースに分割できるか判定する関数。

### ライブラリに追加
```haskell
binSearch :: (Int -> Bool) -> Int -> Int -> Int
binSearch f left right = lowerBound (not. f) left right True - 1
```
`(left, right]`の範囲で、`f x == True` になる最大の`x`を見つける。`f x == True` を満たす最大の`x`は、`f x == False` を満たす最小の`x`から1引いたもとの等しい。また、`True > False`なので、`lowerBound`を使って実装した。
